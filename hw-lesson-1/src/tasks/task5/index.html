<!--
–ó–∞–¥–∞—á–∞ 5. –î–æ–¥–∞—Ç–æ–∫ –º—ñ—Å—Ç–∏—Ç—å –º–∞—Å–∏–≤ –æ–±'—î–∫—Ç—ñ–≤ (–ª–æ–≥—ñ–Ω, –ø–∞—Ä–æ–ª—å) -- —ñ—Å–Ω—É—é—á—ñ –ª–æ–≥—ñ–Ω–∏ —ñ –ø–∞—Ä–æ–ª—ñ. –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –≤–≤–æ–¥–∏—Ç—å –ª–æ–≥—ñ–Ω —ñ –ø–∞—Ä–æ–ª—å, –∞ –ø—Ä–æ–≥—Ä–∞–º–∞ –ø—Ä–∏ –Ω–∞—Ç–∏—Å–Ω–µ–Ω–Ω—ñ –Ω–∞ –∫–Ω–æ–ø–∫—É –ø–æ–≤—ñ–¥–æ–º–ª—è—î —á–∏ –º–æ–∂–µ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –±—É—Ç–∏ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–∏–º.
-->
<!DOCTYPE html>
<html lang="uk">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>–ó–∞–≤–¥–∞–Ω–Ω—è ‚Ññ 5 - –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤</title>
    <link rel="stylesheet" href="../../shared/css/common.css" />
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <div id="root"></div>

    <script
      crossorigin
      src="https://unpkg.com/react@18/umd/react.development.js"
    ></script>
    <script
      crossorigin
      src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"
    ></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script type="text/babel" data-type="module">
      import { authenticateUser } from './js/userManager.js'
      import { validateCredentials } from './js/validation.js'

      function UserAuthentication() {
        const [credentials, setCredentials] = React.useState({
          login: '',
          password: '',
        })
        const [authMessage, setAuthMessage] = React.useState('')

        const handleSubmit = e => {
          e.preventDefault()

          if (!validateCredentials(credentials.login, credentials.password)) {
            setAuthMessage('–ë—É–¥—å –ª–∞—Å–∫–∞, –∑–∞–ø–æ–≤–Ω—ñ—Ç—å —É—Å—ñ –ø–æ–ª—è')
            return
          }

          const result = authenticateUser(
            credentials.login,
            credentials.password
          )
          setAuthMessage(result.message)

          if (result.isAuthenticated) {
            setCredentials({ login: '', password: '' })
          }
        }

        const handleInputChange = field => e => {
          setCredentials(prev => ({
            ...prev,
            [field]: e.target.value,
          }))
          if (authMessage) setAuthMessage('')
        }

        const getMessageClass = () => {
          if (!authMessage) return ''
          return authMessage.includes('—É—Å–ø—ñ—à–Ω–∞')
            ? 'success-message'
            : 'error-message'
        }

        return (
          <div className="container">
            <header className="task-page-header">
              <h1>–ó–∞–≤–¥–∞–Ω–Ω—è ‚Ññ 5</h1>
              <p>–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤</p>
            </header>{' '}
            <div className="task-description-text">
              <h3>üìù –û–ø–∏—Å –∑–∞–≤–¥–∞–Ω–Ω—è:</h3>
              <p>
                <strong>
                  –î–æ–¥–∞—Ç–æ–∫ –º—ñ—Å—Ç–∏—Ç—å –º–∞—Å–∏–≤ –æ–±'—î–∫—Ç—ñ–≤ (–ª–æ–≥—ñ–Ω, –ø–∞—Ä–æ–ª—å) -- —ñ—Å–Ω—É—é—á—ñ
                  –ª–æ–≥—ñ–Ω–∏ —ñ –ø–∞—Ä–æ–ª—ñ. –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –≤–≤–æ–¥–∏—Ç—å –ª–æ–≥—ñ–Ω —ñ –ø–∞—Ä–æ–ª—å, –∞ –ø—Ä–æ–≥—Ä–∞–º–∞
                  –ø—Ä–∏ –Ω–∞—Ç–∏—Å–Ω–µ–Ω–Ω—ñ –Ω–∞ –∫–Ω–æ–ø–∫—É –ø–æ–≤—ñ–¥–æ–º–ª—è—î —á–∏ –º–æ–∂–µ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –±—É—Ç–∏
                  –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–∏–º.
                </strong>
              </p>
            </div>
            <div className="calculator-form">
              <form onSubmit={handleSubmit} className="auth-form">
                <div className="form-group">
                  <label htmlFor="login" className="form-label">
                    –õ–æ–≥—ñ–Ω:
                  </label>
                  <input
                    type="text"
                    id="login"
                    className="form-input"
                    value={credentials.login}
                    onChange={handleInputChange('login')}
                    placeholder="–í–≤–µ–¥—ñ—Ç—å –ª–æ–≥—ñ–Ω..."
                    required
                  />
                </div>

                <div className="form-group">
                  <label htmlFor="password" className="form-label">
                    –ü–∞—Ä–æ–ª—å:
                  </label>
                  <input
                    type="password"
                    id="password"
                    className="form-input"
                    value={credentials.password}
                    onChange={handleInputChange('password')}
                    placeholder="–í–≤–µ–¥—ñ—Ç—å –ø–∞—Ä–æ–ª—å..."
                    required
                  />
                </div>

                <button type="submit" className="calculate-btn">
                  üîê –£–≤—ñ–π—Ç–∏
                </button>
              </form>

              {authMessage && (
                <div className={`auth-result ${getMessageClass()}`}>
                  {authMessage}
                </div>
              )}
            </div>{' '}
            <nav className="navigation">
              <a href="../task4/index.html" className="nav-btn">
                ‚Üê –ü–æ–ø–µ—Ä–µ–¥–Ω—î –∑–∞–≤–¥–∞–Ω–Ω—è
              </a>
            </nav>
          </div>
        )
      }

      const root = ReactDOM.createRoot(document.getElementById('root'))
      root.render(<UserAuthentication />)
    </script>
  </body>
</html>
